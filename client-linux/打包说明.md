# PMS 客户端部署包说明

## 📦 打包内容

这个部署包包含客户端运行所需的所有文件：

```
client_deploy/
├── client/              # 客户端核心文件
│   ├── __init__.py
│   ├── account_manager.py
│   ├── app.py
│   ├── command_executor.py  # 已更新路径查找逻辑
│   ├── config_manager.py
│   └── run.py
├── pmq/                 # 交易机器人依赖（必需）
│   ├── trading_bot.py   # 核心交易模块
│   ├── config.py
│   └── ...
├── requirements.txt     # Python 依赖包
├── run_client.py        # 客户端启动脚本（推荐使用）
├── start.bat            # Windows 启动脚本
├── start.sh             # Linux/Mac 启动脚本
├── README_DEPLOY.md     # 详细部署说明
└── .gitignore           # Git 忽略文件
```

## 🚀 快速开始

### Windows

1. 解压部署包到服务器
2. 双击运行 `start.bat`（会自动创建虚拟环境和安装依赖）
3. 首次运行会提示输入客户端ID和服务端URL

### Linux/Mac

1. 解压部署包到服务器
2. 给启动脚本执行权限：
   ```bash
   chmod +x start.sh
   ```
3. 运行启动脚本：
   ```bash
   ./start.sh
   ```

### 手动启动

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 设置环境变量（可选）
export PMS_CLIENT_ID=client-1
export PMS_SERVER_URL=http://your-server:8000

# 3. 启动
python run_client.py
```

## 📋 必需文件说明

### 核心文件
- **client/** - 客户端核心代码，必需
- **pmq/trading_bot.py** - 交易机器人核心模块，必需
- **pmq/config.py** - 交易配置，必需

### 可选文件
- **pmq/** 目录下的其他文件（如静态资源、模板等）可以删除，不影响功能

## ⚙️ 配置说明

### 环境变量

- `PMS_CLIENT_ID` - 客户端ID（必需，唯一标识）
- `PMS_SERVER_URL` - 服务端URL（必需，例如：http://192.168.1.100:8000）

### 配置文件

首次运行后会在 `client/data/client/` 目录下生成：
- `config.json` - 客户端配置（客户端ID、服务端URL等）

## 📝 注意事项

1. **路径依赖**：`command_executor.py` 已更新为自动查找 `pmq` 目录，支持多种目录结构
2. **数据存储**：客户端数据存储在 `client/data/` 目录，请定期备份
3. **端口**：默认监听 9000 端口，确保防火墙开放
4. **Python 版本**：需要 Python 3.7 或更高版本

## 🔧 故障排查

如果遇到导入错误：
1. 确保 `pmq` 目录存在且包含 `trading_bot.py`
2. 确保已安装所有依赖：`pip install -r requirements.txt`
3. 检查 Python 路径：`python --version`

## 📞 支持

更多详细信息请查看 `README_DEPLOY.md`

